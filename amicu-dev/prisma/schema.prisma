generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model conversation {
  id                                                             BigInt              @id @unique @default(autoincrement())
  created_at                                                     DateTime            @default(now()) @db.Timestamptz(6)
  message_message_conversationToconversation                     message[]           @relation("message_conversationToconversation")
  project_project_conversationToconversation                     project[]           @relation("project_conversationToconversation")
  user_conversation_user_conversation_conversationToconversation user_conversation[] @relation("user_conversation_conversationToconversation")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model message {
  id                                              BigInt        @id @unique @default(autoincrement())
  created_at                                      DateTime      @default(now()) @db.Timestamptz(6)
  contents                                        String?       @default("")
  sender                                          BigInt?
  conversation                                    BigInt?
  conversation_message_conversationToconversation conversation? @relation("message_conversationToconversation", fields: [conversation], references: [id], onDelete: Cascade)
  user                                            user?         @relation(fields: [sender], references: [id], onDelete: SetDefault)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model project {
  id                                              BigInt         @id @unique @default(autoincrement())
  created_at                                      DateTime       @default(now()) @db.Timestamptz(6)
  description                                     String         @default("")
  title                                           String         @default("")
  thumbnail                                       String         @default("")
  conversation                                    BigInt?
  github                                          String         @default("")
  links                                           String[]
  conversation_project_conversationToconversation conversation?  @relation("project_conversationToconversation", fields: [conversation], references: [id], onDelete: SetDefault)
  project_tag_project_tag_projectToproject        project_tag[]  @relation("project_tag_projectToproject")
  user_project_user_project_projectToproject      user_project[] @relation("user_project_projectToproject")
  waiting_list_waiting_list_projectToproject      waiting_list[] @relation("waiting_list_projectToproject")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model tag {
  id                               BigInt        @id @unique @default(autoincrement())
  name                             String?       @unique @default("")
  project_tag_project_tag_tagTotag project_tag[] @relation("project_tag_tagTotag")
  user_tag_user_tag_tagTotag       user_tag[]    @relation("user_tag_tagTotag")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model user {
  id                                             BigInt              @id @unique @default(autoincrement())
  created_at                                     DateTime            @default(now()) @db.Timestamptz(6)
  user_id                                        String?             @unique @default(dbgenerated("requesting_user_id()"))
  bio                                            String?             @default("")
  links                                          Json[]
  message                                        message[]
  user_conversation_user_conversation_userTouser user_conversation[] @relation("user_conversation_userTouser")
  user_project_user_project_userTouser           user_project[]      @relation("user_project_userTouser")
  user_tag_user_tag_userTouser                   user_tag[]          @relation("user_tag_userTouser")
  waiting_list_waiting_list_userTouser           waiting_list[]      @relation("waiting_list_userTouser")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model user_conversation {
  id                                                        BigInt        @id @unique @default(autoincrement())
  created_at                                                DateTime      @default(now()) @db.Timestamptz(6)
  user                                                      BigInt?
  conversation                                              BigInt?
  conversation_user_conversation_conversationToconversation conversation? @relation("user_conversation_conversationToconversation", fields: [conversation], references: [id], onDelete: Cascade)
  user_user_conversation_userTouser                         user?         @relation("user_conversation_userTouser", fields: [user], references: [id], onDelete: Cascade)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model user_project {
  id                                    BigInt   @id @unique @default(autoincrement())
  created_at                            DateTime @default(now()) @db.Timestamptz(6)
  user                                  BigInt
  project                               BigInt
  role                                  Int      @default(3) @db.SmallInt
  project_user_project_projectToproject project  @relation("user_project_projectToproject", fields: [project], references: [id], onDelete: Cascade)
  user_user_project_userTouser          user     @relation("user_project_userTouser", fields: [user], references: [id], onDelete: Cascade)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model user_tag {
  id                       BigInt   @id @unique @default(autoincrement())
  created_at               DateTime @default(now()) @db.Timestamptz(6)
  user                     BigInt?
  tag                      BigInt?
  complexity               Int      @default(1) @db.SmallInt
  tag_user_tag_tagTotag    tag?     @relation("user_tag_tagTotag", fields: [tag], references: [id], onDelete: Cascade)
  user_user_tag_userTouser user?    @relation("user_tag_userTouser", fields: [user], references: [id], onDelete: Cascade)

  @@unique([user, tag], map: "unique_user_tag")
}

model waiting_list {
  id                                    BigInt   @id @unique @default(autoincrement())
  created_at                            DateTime @default(now()) @db.Timestamptz(6)
  user                                  BigInt
  project                               BigInt
  project_waiting_list_projectToproject project  @relation("waiting_list_projectToproject", fields: [project], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_waiting_list_userTouser          user     @relation("waiting_list_userTouser", fields: [user], references: [id], onDelete: Cascade)
}

model project_tag {
  id                                   BigInt   @id @default(autoincrement())
  created_at                           DateTime @default(now()) @db.Timestamptz(6)
  project                              BigInt?
  tag                                  BigInt?
  complexity                           Int      @default(1) @db.SmallInt
  project_project_tag_projectToproject project? @relation("project_tag_projectToproject", fields: [project], references: [id], onDelete: Cascade)
  tag_project_tag_tagTotag             tag?     @relation("project_tag_tagTotag", fields: [tag], references: [id], onDelete: Cascade)
}
